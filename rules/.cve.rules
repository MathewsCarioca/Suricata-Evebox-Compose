#Esse Ã© um arquivo de regras para o suricata baseada em CVEs.

#Lista de CVEs
#CVE-2016-0800
#CVE-2016-1285
#CVE-2016-2208
#CVE-2016-2386
#CVE-2016-3078
#CVE-2016-3087
#CVE-2016-4010
#CVE-2016-4971
#CVE-2016-6304
#CVE-2016-6366
#CVE-2016-6367
#CVE-2016-6662
#CVE-2016-7237
#CVE-2016-7636
#CVE-2016-9147
#CVE-2016-9565
#CVE-2017-13089
#CVE-2017-14492
#CVE-2017-14493
#CVE-2017-14494
#CVE-2017-16943
#CVE-2017-2491
#CVE-2017-3143
#CVE-2017-5638
#CVE-2017-7269
#CVE-2017-7494
#CVE-2017-8045
#CVE-2017-9798
#CVE-2018-0171
#CVE-2018-0886
#CVE-2018-1000006
#CVE-2018-1000207
#CVE-2018-1111
#CVE-2018-1306
#CVE-2018-14847
#CVE-2018-15379
#CVE-2018-15442
#CVE-2018-15454
#CVE-2018-17245
#CVE-2018-5955
#CVE-2018-6789
#CVE-2018-7445
#CVE-2018-7600
#CVE-2018-7602
#CVE-2018-8495
#CVE-2018-8581
#CVE-2019-0227
#CVE-2019-0232
#CVE-2019-0708
#CVE-2019-1003001
#CVE-2019-2618
#CVE-2019-2725
#CVE-2019-3396
#CVE-2019-3924
#CVE-2019-3978
#CVE-2019-6340
#CVE-2020-0601
#CVE-2020-0796
#CVE-2020-1350
#CVE-2020-14882
#CVE-2021-41773
#CVE-2022-23131


#CVE-2016-0800
#The SSLv2 protocol, as used in OpenSSL before 1.0.1s and 1.0.2 before 1.0.2g and other products, requires a server to send a ServerVerify message before establishing that a client possesses certain plaintext RSA data,
#which makes it easier for remote attackers to decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA padding oracle, aka a "DROWN" attack.

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] SSLv2 Hello flood. Possible DROWN attack"; flow: established,to_server; ssl_version: sslv2; ssl_state: client_hello; content: "|01 00 02|"; offset: 2; depth: 3; threshold: type both, track by_src, count 30, seconds 10; reference: url, drownattack.com; reference: cve, 2016-0800; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; reference: url, https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0800; sid: 10000010; rev:1;)

#CVE-2016-1285
#named in ISC BIND 9.x before 9.9.8-P4 and 9.10.x before 9.10.3-P4 does not properly handle DNAME records when parsing fetch reply messages, 
#which allows remote attackers to cause a denial of service (assertion failure and daemon exit) via a malformed packet to the rndc (aka control channel) interface, related to alist.c and sexpr.c.

alert tcp any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Attempt to crash named using malformed RNDC packet"; flow: established, to_server; content:"_auth"; depth: 20; fast_pattern; content: !"|02 00 00 00|"; within: 4; content: "_ctrl"; content: "_ser"; content: "_tim"; content: "_exp"; reference: cve, 2016-1285; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; reference: url, https://cve.mitre.org/cgi-bin/cvename.cgi?name=2016-1285; sid: 10000005; rev: 3; )

alert tcp any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Attempt to crash named using malformed RNDC packet"; flow: established, to_server; content:"_auth"; depth: 20; fast_pattern; content: !"|01 00 00 00|"; distance: 10; within: 4; content: "_ctrl"; content: "_ser"; content: "_tim"; content: "_exp"; reference: cve, 2016-1285; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000006; rev: 3; )

#CVE-2016-2208
#The kernel component in Symantec Anti-Virus Engine (AVE) 20151.1 before 20151.1.1.4 allows remote attackers to execute arbitrary code or cause a denial of service (memory access violation and system crash)
#via a malformed PE header file.

alert ip $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] RCE attempt via malformed ASPack"; content: "M"; offset: 0; depth: 2; content: "Z"; distance: -2; within: 3; content: "PE"; offset: 64; depth: 2; byte_test: 4, >, 0, 70, little; byte_extract: 4, 144, cve20162208, little; byte_test: 4, >, cve20162208, 328, little; reference: cve, 2016-2208; reference: url, bugs.chromium.org/p/project-zero/issues/detail?id=820; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000057; rev: 1;)

#CVE-2016-2386
#SQL injection vulnerability in the UDDI server in SAP NetWeaver J2EE Engine 7.40 allows remote attackers to execute arbitrary SQL commands via unspecified vectors, aka SAP Security Note 2101079.

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] SAP NetWeaver AS Java UDDI 7.11-7.50 SQL Injection (CVE-2016-2386)"; flow: established, to_server; content: "POST"; http_method; content: "/UDDISecurityService/UDDISecurityImplBean"; http_uri; fast_pattern; content: "permissionId"; http_client_body; content: "|27|"; http_client_body; distance: 0; pcre: "/permissionId\s*>[^<]+?\x27/Pi"; reference: cve, 2016-2386; reference: url, github.com/vah13/SAP_exploit; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10002408; rev: 1; )

#CVE-2016-3078
#Multiple integer overflows in php_zip.c in the zip extension in PHP before 7.0.6 allow remote attackers to cause a denial of service (heap-based buffer overflow and application crash)
# or possibly have unspecified other impact via a crafted call to (1) getFromIndex or (2) getFromName in the ZipArchive class.

alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] PHP7 x86 heap overflow attempt via crafted zip archive"; flow: established, to_server; content: "POST"; http_method; content:"PK|01 02|"; fast_pattern; content: "|FF FF FF|"; distance: 21; within: 3; content:"PK|01 02|"; distance: 0; content: "|FF FF FF|"; distance: 21; within: 3; content:"PK|01 02|"; distance: 0; content: "|FF FF FF|"; distance: 21; within: 3; content:"PK|01 02|"; distance: 0; content: "|FF FF FF|"; distance: 21; within: 3; reference: cve, 2016-3078; reference: url, github.com/dyntopia/exploits/blob/master/CVE-2016-3078; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10000037; rev: 1; )

#CVE-2016-3087
#Apache Struts 2.3.19 to 2.3.20.2, 2.3.21 to 2.3.24.1, and 2.3.25 to 2.3.28, when Dynamic Method Invocation is enabled, allow remote attackers to execute arbitrary code via vectors related to an ! (exclamation mark) 
#operator to the REST Plugin.

alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Apache Struts 2.3.20-2.3.28.1 Privilege Escalation attempt"; content: "#_memberAccess"; http_uri; content: "="; http_uri; distance: 0; content: "@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS"; http_uri; distance: 0; reference: cve, 2016-0785; reference: cve, 2016-3081; reference: cve, 2016-3087; reference: cve, 2016-3093; reference: cve, 2016-4438; reference: url, struts.apache.org/docs/s2-029.html; reference: url, struts.apache.org/docs/s2-032.html; reference: url, struts.apache.org/docs/s2-033.html; reference: url, struts.apache.org/docs/s2-034.html; reference: url, struts.apache.org/docs/s2-037.html; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10000049; rev: 1;)

#CVE-2016-4010
#Magento CE and EE before 2.0.6 allows remote attackers to conduct PHP objection injection attacks and execute arbitrary PHP code via crafted serialized shopping cart data.

alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Magento < 2.0.6 Arbitrary write file"; content: "rest/V1/guest-carts/"; http_raw_uri; content: "set-payment-information"; http_raw_uri; fast_pattern; content: "|5C 75 30 30 30 30|"; content: "Magento\\\\Sales\\\\Model\\\\Order\\\\Payment\\\\Transaction"; reference: cve, 2016-4010; reference: url, netanelrub.in/2016/05/17/magento-unauthenticated-remote-code-execution; classtype: web-application-attack; reference: url, github.com/ptresearch/AttackDetection; sid: 10000042; rev: 1;)

#CVE-2016-4971
#GNU wget before 1.18 allows remote servers to write to arbitrary files by redirecting a request from HTTP to a crafted FTP resource.

alert http $HOME_NET any -> $EXTERNAL_NET any (msg: "ATTACK [PTsecurity] GNU Wget http request"; content: "wget"; http_user_agent; nocase; depth: 4; flowbits: set, 10000062; flowbits: noalert; reference: cve, 2016-4971; classtype:bad-unknown; reference: url, legalhackers.com/advisories/Wget-Arbitrary-File-Upload-Vulnerability-Exploit.txt; reference: url, github.com/ptresearch/AttackDetection; sid: 10000062; rev: 2; )

alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] GNU Wget < 1.18 Arbitrary File Upload / Potential Remote Code Execution"; flowbits: isset, 10000062; content: "30"; http_stat_code; depth: 2; content: "Location: ftp://"; nocase; http_header; reference: cve, 2016-4971; classtype:bad-unknown; reference: url, legalhackers.com/advisories/Wget-Arbitrary-File-Upload-Vulnerability-Exploit.txt; reference: url, github.com/ptresearch/AttackDetection; sid: 10000063; rev: 2; )

#CVE-2016-6304
#Multiple memory leaks in t1_lib.c in OpenSSL before 1.0.1u, 1.0.2 before 1.0.2i, and 1.1.0 before 1.1.0a allow remote attackers to cause a denial of service (memory consumption) via large OCSP Status Request extensions.

alert tls $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Likely OpenSSL TLS renegotiations DoS"; flow: to_server, no_stream; content: "|16|"; depth: 1; flowint: tlshandshakecount, +, 1; flowbits: noalert; reference: url, security.360.cn/cve/CVE-2016-6304/; reference: cve, 2016-6304; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000131; rev: 3; )

#CVE-2016-6366
#Buffer overflow in Cisco Adaptive Security Appliance (ASA) Software through 9.4.2.3 on ASA 5500, ASA 5500-X, ASA Services Module, ASA 1000V, ASAv, Firepower 9300 ASA Security Module, PIX,
# and FWSM devices allows remote authenticated users to execute arbitrary code via crafted IPv4 SNMP packets, aka Bug ID CSCva92151 or EXTRABACON.

alert udp any any -> $HOME_NET 161 (msg: "ATTACK [PTsecurity] Cisco Adaptive Security Appliance 8.x SNMP overflow RCE Probe"; content: "|a035020100020100020100302a300c06082b060102010101000500300c06082b060102010103000500300c06082b060102010105000500|"; isdataat:!1, relative; reference: url, blogs.cisco.com/security/shadow-brokers; reference: cve, 2016-6366; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10000098; rev: 2; )

alert udp any any -> $HOME_NET 161 (msg: "ATTACK [PTsecurity] Cisco Adaptive Security Appliance 8.x SNMP overflow RCE Attempt"; byte_jump:1, 6; content: "|A5|"; content: "|2B 06 01 02 01 01 01|"; distance: 0; content: "|2B 06 01 04 01 09 09 83 6B 01 03 03 01 01 05 09|"; isdataat:30,relative; reference: url, blogs.cisco.com/security/shadow-brokers; reference: cve, 2016-6366; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10000099; rev: 2; )

#CVE-2016-6367
#Cisco Adaptive Security Appliance (ASA) Software before 8.4(1) on ASA 5500, ASA 5500-X, PIX, and FWSM devices allows local users to gain privileges via invalid CLI commands, aka Bug ID CSCtu74257 or EPICBANANA.

alert tcp any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] EpicBanana Exploitation"; content: "|50 16 60 16 b8 16 82 16 aa 16 aa 16 aa 16 35 16 aa 16 aa 16 aa 16 aa|"; depth: 24; classtype: attempted-admin; reference: url, tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20160817-asa-cli; reference: cve, 2016-6367; reference: url, github.com/ptresearch/AttackDetection; sid:10000125; rev:1;)

#CVE-2016-6662
#Oracle MySQL through 5.5.52, 5.6.x through 5.6.33, and 5.7.x through 5.7.15; MariaDB before 5.5.51, 10.0.x before 10.0.27, and 10.1.x before 10.1.17; and Percona Server before 5.5.51-38.1, 5.6.x before 5.6.32-78.0, and 5.7.x 
#before 5.7.14-7 allow local users to create arbitrary configurations and bypass certain protection mechanisms by setting general_log_file to a my.cnf configuration. 
#NOTE: this can be leveraged to execute arbitrary code with root privileges by setting malloc_lib. NOTE: the affected MySQL version information is from Oracle's October 2016 CPU. 
#Oracle has not commented on third-party claims that the issue was silently patched in MySQL 5.5.52, 5.6.33, and 5.7.15.

alert tcp any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] MySQL <= 5.7.15, 5.6.33, 5.5.53 root RCE/Privilege Escalation attempt"; content:"|03|"; offset:4; depth:1; content:"736574"; distance:0; content:"6c6f675f66696c65"; distance:0; content:"6d79"; distance:0; content:"2e636e66"; distance:0; within:14; reference: url, legalhackers.com/advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html; reference: cve, 2016-6662; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid:10000128; rev:1;)

alert tcp any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] MySQL <= 5.7.15, 5.6.33, 5.5.53 root RCE/Privilege Escalation attempt"; content:"|03|"; offset:4; depth:1; content:"set"; distance:0; content:"log_file"; distance:0; content:"my"; distance:0; content:".cnf"; distance:0; within:7; reference: url, legalhackers.com/advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html; reference: cve, 2016-6662; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid:10000129; rev:1;)

#CVE-2016-7237
#Local Security Authority Subsystem Service (LSASS) in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, Windows 10 Gold, 1511, and 1607,
# and Windows Server 2016 allows remote authenticated users to cause a denial of service (system hang) via a crafted request, aka "Local Security Authority Subsystem Service Denial of Service Vulnerability."

alert tcp any any -> any 445 (msg: "ATTACK [PTsecurity] LSASS Remote Memory Corruption Attempt (MS16-137)"; flow: established, no_stream; content: "|FF|SMB|73 00 00 00 00|"; offset: 4; depth: 9; content: "|FF 00|"; offset: 37; depth: 2; content: "|01 00 00 00 00 00|"; offset: 45; depth: 6; content: "|00 00 00 00 D4 00 00 A0|"; distance: 2; within: 8; content: "|A1 84|"; distance: 2; within: 2; byte_test:1,!=,0xD1,0,relative; flowbits: set, CVE.2016-7237.Attempt; xbits:set,CVE.2016-7237.Attempt,track ip_dst,expire 15; reference: cve, 2016-7237; reference: url, g-laurent.blogspot.ru/2016/11/ms16-137-lsass-remote-memory-corruption.html; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000532; rev: 2; )

alert tcp any 445 -> any any (msg: "ATTACK [PTsecurity] LSASS Remote Memory Corruption Successful LSASS Inf. loop (MS16-137)"; flow: established, no_stream; content: "|FF|SMB|73 05 02 00 C0|"; offset: 4; depth: 9; flowbits: isset, CVE.2016-7237.Attempt; reference: cve, 2016-7237; reference: url, g-laurent.blogspot.ru/2016/11/ms16-137-lsass-remote-memory-corruption.html; classtype: successful-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000533; rev: 2;)

#CVE-2016-7636
#An issue was discovered in certain Apple products. iOS before 10.2 is affected. macOS before 10.12.2 is affected. watchOS before 3.1.3 is affected.
#The issue involves the "Security" component, which allows man-in-the-middle attackers to cause a denial of service (application crash) via vectors related to OCSP responder URLs.

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Apple macOS 10.12.1/iOS 10 OCSP DDoS Attempt (CVE-2016-7636)"; flow: established, from_server, only_stream; content: "|16 03|"; depth: 2; content: "|16 03|"; content: "|0B|"; distance: 3; within: 1; content: "|30 83|"; content: "|30|"; distance: 3; within: 1; content: "|06 08 2B 06 01 05 05 07 30 02 86|"; distance: 1; within: 11; byte_jump: 1, 0, relative; content: "|30|"; content: "|06 08 2B 06 01 05 05 07 30 02 86|"; distance: 1; within: 11; byte_jump: 1, 0, relative; content: "|30|"; pcre: "/(?:[^\x06]+\x06\x08\x2B\x06\x01\x05\x05\x07\x30\x02\x86){10,}/"; reference: cve, 2016-7636; reference: url, cxsecurity.com/issue/WLB-2016100213; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000495; rev: 1; )

#CVE-2016-9147
#named in ISC BIND 9.9.9-P4, 9.9.9-S6, 9.10.4-P4, and 9.11.0-P1 allows remote attackers to cause a denial of service (assertion failure and daemon exit) via a response containing an inconsistency among the DNSSEC-related RRsets.

alert dns any any -> $HOME_NET any (msg: "INFO [PTsecurity] DNS RRSIG without covered RR (CVE-2016-9147)"; flow: established, from_server; content: "|00 01 00 01|"; offset: 4; depth: 6; content: "|00 00|"; distance: 0; content: "|00 01|"; distance: 1; within: 2; content: "|00 2E 00|"; fast_pattern; distance: 0; pcre: "/.{4,6}\x00\x01\x00\x01.{4}[^\x00]+\x00.{4}[^\x00]+\x00(?:\x2e|\x00\x2e)/"; reference: cve, 2016-9147; reference: url, kb.isc.org/article/AA-01440/74/CVE-2016-9147%3A-An-error-handling-a-query-response-containing-inconsistent-DNSSEC-information-could-cause-an-assertion-failure-.html; classtype: attempted-dos; reference: url, github.com/ptresearch/AttackDetection; sid: 10000892; rev: 2; )

#CVE-2016-9565
#MagpieRSS, as used in the front-end component in Nagios Core before 4.2.2 might allow remote attackers to read or write to arbitrary files by spoofing a crafted response from the Nagios RSS feed server.
#NOTE: this vulnerability exists because of an incomplete fix for CVE-2008-4796.

alert http $HOME_NET any -> any any (msg: "ATTACK [PTsecurity] Nagios Core < 4.2.2 Curl Command Injection (CVE-2016-9565) RSS Request"; flow:established, to_server; content: "/nagios/rss-"; http_uri; content: ".php"; http_uri; distance: 0; content: "User-Agent: magpie"; http_header; nocase; flowbits: set, CVE.2016-9565.RSSRequest; reference: url, legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html; reference: cve, 2016-9565; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10000777; rev: 1; )

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Nagios Core < 4.2.2 Curl Command Injection (CVE-2016-9565) Attempt"; flow:established, from_server; content: "302"; http_stat_code; content: "nagios"; http_header; flowbits: isset, CVE.2016-9565.RSSRequest; reference: url, legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html; reference: cve, 2016-9565; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10000778; rev: 1; )

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Nagios Core < 4.2.2 Curl Command Injection (CVE-2016-9565) Remote Script Execution"; flow:established, from_server; content: "302"; http_stat_code; content: "--trace-ascii"; http_header; content: " -F"; http_header; pcre: "/Location\:(?:.*?\s+-F\S+\s+){2}/Hi"; flowbits: isset, CVE.2016-9565.RSSRequest; reference: url, legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html; reference: cve, 2016-9565; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10000779; rev: 1; )

#CVE-2017-13089
#The http.c:skip_short_body() function is called in some circumstances, such as when processing redirects. When the response is sent chunked in wget before 1.19.2, the chunk parser uses strtol() to read each chunk's length,
#but doesn't check that the chunk length is a non-negative number. The code then tries to skip the chunk in pieces of 512 bytes by using the MIN() macro, but ends up passing the negative chunk length to connect.c:fd_read().
#As fd_read() takes an int argument, the high 32 bits of the chunk length are discarded, leaving fd_read() with a completely attacker controlled length argument.

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Buffer Overflow via Negative HTTP Chunk size number (FFMPEG CVE-2016-10190, WGET CVE-2017-13089, CVE-2017-13090)"; flow: established, from_server; content: "Transfer-Encoding"; nocase; http_header; content: "chunked"; http_header; nocase; distance: 0; app-layer-event:http.invalid_response_chunk_len; pcre: "/^\s*-[0-9A-Fa-f]+/Qs"; reference: cve, 2016-10190; reference: cve, 2017-13089; reference: cve, 2017-13090; reference: url, trac.ffmpeg.org/ticket/5992; reference: url, bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-13089; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001108; rev: 2; )

#CVE-2017-14492
#Heap-based buffer overflow in dnsmasq before 2.78 allows remote attackers to cause a denial of service (crash) or execute arbitrary code via a crafted IPv6 router advertisement request.

alert icmp any any -> any any (msg: "ATTACK [PTsecurity] Dnsmasq <2.78 Heap Based Buffer Overflow (CVE-2017-14492)"; itype:133; icode: 0; content: "|01|"; offset: 4; depth: 1; byte_test: 1, >, 150, 0, relative; isdataat:1500, relative; reference: cve, 2017-14492; reference: url, security.googleblog.com/2017/10/behind-masq-yet-more-dns-and-dhcp.html; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002469; rev: 2; )

#CVE-2017-14493
#Stack-based buffer overflow in dnsmasq before 2.78 allows remote attackers to cause a denial of service (crash) or execute arbitrary code via a crafted DHCPv6 request.

alert udp any any -> any 547 (msg: "ATTACK [PTsecurity] Possible Dnsmasq <2.78 DHCPv6 Link Layer Address Stack Overflow (CVE-2017-14493)"; flow: no_stream; content: "|0C|"; depth: 1; content: "|00 4F|"; distance: 33; within: 2; byte_test: 2, >, 16, 0, relative, big; isdataat:18,relative; reference: cve, 2017-14493; reference: url, security.googleblog.com/2017/10/behind-masq-yet-more-dns-and-dhcp.html; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002473; rev: 1; )

#CVE-2017-14494
#dnsmasq before 2.78, when configured as a relay, allows remote attackers to obtain sensitive memory information via vectors involving handling DHCPv6 forwarded requests.

alert udp any any -> any 547 (msg: "ATTACK [PTsecurity] Possible Dnsmasq <2.78 DHCPv6 Sensitive info leak (CVE-2017-14494)"; flow: no_stream; content: "|0C|"; depth: 1; content: "|00 09|"; distance: 33; within: 2; content: "|00 01|"; distance: 24; within: 2; byte_test: 2, >, 2, 0, relative, big; isdataat:!3,relative; reference: cve, 2017-14494; reference: url, security.googleblog.com/2017/10/behind-masq-yet-more-dns-and-dhcp.html; classtype: attempted-recon; reference: url, github.com/ptresearch/AttackDetection; sid: 10002475; rev: 1; )

#CVE-2017-16943
#The receive_msg function in receive.c in the SMTP daemon in Exim 4.88 and 4.89 allows remote attackers to execute arbitrary code or cause a denial of service (use-after-free) via vectors involving BDAT commands.

alert smtp any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Exim 4.88, 4.89 UAF RCE Attempt (CVE-2017-16943)"; flow: established, to_server; content: "BDAT"; content: "BDAT"; within: 10; pcre: "/BDAT\s*\D[^\n\r]*[\n\r][^\n\r]{100}/"; reference: cve, 2017-16943; reference: url, bugs.exim.org/show_bug.cgi?id=2199; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002280; rev: 2; )

#CVE-2017-2491
#Use after free vulnerability in the String.replace method JavaScriptCore in Apple Safari in iOS before 10.3 allows remote attackers to execute arbitrary code via a crafted web page, or a crafted file.

alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Safari 10.0.3 UAF RCE (CVE-2017-2491)"; flow: established, from_server; file_data; content: "RegExp"; content: ".repeat"; within: 25; content: ".repeat"; within: 50; content: ".repeat"; within: 50; content: "ArrayBuffer"; within: 100; content: "Uint8Array"; within: 50; content: "Float64Array"; within: 50; content: "jsCellHeader"; distance: 0; content: "butterfly"; distance: 0; reference: cve, 2017-2491; reference: url, github.com/phoenhex/files/blob/master/exploits/cachedcall-uaf.html; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001322; rev: 2; )

alert http $EXTERNAL_NET any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Safari 10.0.3 UAF RCE (CVE-2017-2491)"; flow: established, from_server; file_data; content: "0x40000"; content: "0x1000"; content: "0x10000000"; content: "0x7ffff000"; content: "0x80"; content: "0x81"; content: "0x50"; reference: cve, 2017-2491; reference: url, github.com/phoenhex/files/blob/master/exploits/cachedcall-uaf.html; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001326; rev: 1; )

#CVE-2017-3143
#An attacker who is able to send and receive messages to an authoritative DNS server and who has knowledge of a valid TSIG key name for the zone and service being targeted may be able to manipulate BIND into accepting
#an unauthorized dynamic update. Affects BIND 9.4.0->9.8.8, 9.9.0->9.9.10-P1, 9.10.0->9.10.5-P1, 9.11.0->9.11.1-P1, 9.9.3-S1->9.9.10-S2, 9.10.5-S1->9.10.5-S2.

alert dns any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] ISC BIND DNS TSIG authentication bypass attempt (CVE-2017-3143, HMAC_SHA256)"; flow: to_server; content: "|00 FA|"; content: "|00 00 00 00|"; distance: 2; within: 4; content: "|0B|hmac-sha256|00|"; within: 15; byte_test: 2, >, 32, 8, relative; flowbits: set, CVE.2017-3143.attempt; reference: cve, 2017-3143; reference: url, http://www.synacktiv.ninja/ressources/CVE-2017-3143_BIND9_TSIG_dynamic_updates_vulnerability_Synacktiv.pdf; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001502; rev: 1; )

alert dns any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] ISC BIND DNS TSIG authentication bypass successful (CVE-2017-3143)"; flow: from_server; content: "|00 FA|"; content: "|00 00 00 00|"; distance: 2; within: 4; content: "|0B|hmac-sha256|00|"; within: 15; byte_test: 2, >, 0, 8, relative; flowbits: isset,CVE.2017-3143.attempt; flowbits: unset,CVE.2017-3143.attempt; reference: cve, 2017-3143; reference: url, http://www.synacktiv.ninja/ressources/CVE-2017-3143_BIND9_TSIG_dynamic_updates_vulnerability_Synacktiv.pdf; classtype: successful-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001508; rev: 2; )

#CVE-2017-5638
#The Jakarta Multipart parser in Apache Struts 2 2.3.x before 2.3.32 and 2.5.x before 2.5.10.1 has incorrect exception handling and error-message generation during file-upload attempts, which allows remote attackers
#to execute arbitrary commands via a crafted Content-Type, Content-Disposition, or Content-Length HTTP header, as exploited in the wild in March 2017 with a Content-Type header containing a #cmd= string.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Apache Struts < 2.3.32 < 2.5.10.1 RCE through Jakarta Multipart parser Attempt"; flow: established, to_server; content: "%{"; fast_pattern; http_header; content: "multipart/form-data"; http_header; content: "#_memberAccess"; http_header; content: "@java"; http_header; reference: cve, 2017-5638; reference: url, paper.seebug.org/241/; classtype:attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001065; rev: 3;)

#CVE-2017-7269
#Buffer overflow in the ScStoragePathFromUrl function in the WebDAV service in Internet Information Services (IIS) 6.0 in Microsoft Windows Server 2003 R2 allows remote attackers to execute arbitrary code via a long header 
#beginning with "If: <http://" in a PROPFIND request, as exploited in the wild in July or August 2016.

alert http any any -> $HOME_NET any (msg:"ATTACK [PTsecurity] MS IIS 6.0 BO RCE (CVE-2017-7269)"; flow: to_server, established; content: "PROPFIND"; http_method; content: "If: <"; http_header; nocase;  pcre: "/^If: <[^\r\n>]+[\x7F-\xFF]/Hmi"; reference:url, www.helpnetsecurity.com/2017/03/30/cve-2017-7269/; reference: cve, 2017-7269; classtype:attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10001195; rev: 1;)

#CVE-2017-7494
#Samba since version 3.5.0 and before 4.6.4, 4.5.10 and 4.4.14 is vulnerable to remote code execution vulnerability, allowing a malicious client to upload a shared library to a writable share,
#and then cause the server to load and execute it.

alert smb any any -> $HOME_NET any (msg:"ATTACK [PTsecurity] Samba RCE exploitation attempt (SambaCry)"; flow: to_server, established, no_stream; content: "|ff 53 4d 42 a2|"; offset: 4; depth: 5; byte_extract: 2, 85, name_length, little; content: "|2f|"; distance: 2; within:name_length; content: !"|04|"; distance: 0; within: 1; reference: cve, 2017-7494; reference: url, www.samba.org/samba/security/CVE-2017-7494.html; reference: url, thehackernews.com/2017/05/samba-rce-exploit.html; classtype: attempted-user; reference: url, github.com/ptresearch/AttackDetection; sid: 10001356; rev: 5;)

alert smb any any -> $HOME_NET any (msg:"ATTACK [PTsecurity] Samba RCE exploitation attempt (SambaCry)"; flow: to_server, established, no_stream; content: "|fe 53 4d 42|"; offset: 4; depth: 4; content: "|05 00|"; offset: 16; depth: 2; fast_pattern; byte_extract: 2, 114, name_length, little; byte_jump: 2, 112, little, from_beginning, post_offset 4; content: "|2f|"; distance:0; within:name_length; content: !"|04|"; distance:0; within: 1; reference: cve, 2017-7494; reference: url, www.samba.org/samba/security/CVE-2017-7494.html; reference: url, thehackernews.com/2017/05/samba-rce-exploit.html; classtype: attempted-user; reference: url, github.com/ptresearch/AttackDetection; sid: 10001357; rev: 5;)

alert smb any any -> $HOME_NET any (msg:"ATTACK [PTsecurity] Samba RCE exploitation attempt (SambaCry)"; flow: to_server, established, no_stream; content: "|ff 53 4d 42 2d|"; offset: 4; depth: 5; byte_extract: 2, 67, name_length, little; content: "|2f|"; distance: 2; within:name_length; content: !"|04|"; distance: 0; within: 1; reference: cve, 2017-7494; reference: url, www.samba.org/samba/security/CVE-2017-7494.html; reference: url, thehackernews.com/2017/05/samba-rce-exploit.html; classtype: attempted-user; reference: url, github.com/ptresearch/AttackDetection; sid: 10001438; rev: 1;)

#CVE-2017-8045
#In Pivotal Spring AMQP versions prior to 1.7.4, 1.6.11, and 1.5.7, an org.springframework.amqp.core.Message may be unsafely deserialized when being converted into a string. 
#A malicious payload could be crafted to exploit this and enable a remote code execution attack.

alert tcp $HOME_NET 5672 -> $HOME_NET any (msg: "ATTACK [PTsecurity] Spring AMQP <1.7.4, 1.6.11, 1.5.7 Java Object Deserialization RCE (CVE--2017-8045)"; flow: established, no_stream; content: "application/x-java-serialized-object"; nocase; content: "|03|"; distance: 1; within: 1; content: "java."; distance: 0; pcre: "/application/x-java-serialized-object.{0,110}(?:org\.(?:apache\.|springframework\.|jboss\.|hibernate\.)|java(?:x\.management\.|\.rmi\.)|com\.sun\.|sun\.reflect\.)/"; reference: cve, 2017-8045; reference: url, pivotal.io/security/cve-2017-8045; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002274; rev: 1; )

#CVE-2017-9798
#Apache httpd allows remote attackers to read secret data from process memory if the Limit directive can be set in a user's .htaccess file, or if httpd.conf has certain misconfigurations, aka Optionsbleed. 
#This affects the Apache HTTP Server through 2.2.34 and 2.4.x through 2.4.27. The attacker sends an unauthenticated OPTIONS HTTP request when attempting to read secret data. 
#This is a use-after-free issue and thus secret data is not always sent, and the specific data depends on many factors including configuration. 
#Exploitation with .htaccess can be blocked with a patch to the ap_limit_section function in server/core.c.

alert http $HOME_NET any -> any any (msg: "ATTACK [PTsecurity] Apache2 <2.2.34 <2.4.27 Optionsbleed (CVE-2017-9798) Leak"; flow: established, from_server; content: "Allow:"; nocase; http_header; pcre: "/Allow:(?: ,|[^\r\n]*(?:[^A-Za-z0-9,\s\-_]|,,))/Hi"; threshold: type limit, track by_src, count 1, seconds 10; reference: cve, 2017-9798; reference: url, blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html; reference: url, github.com/ptresearch/AttackDetection; metadata: Open Ptsecurity.com ruleset;  metadata: updated_at 2021_09_29; classtype: attempted-recon; sid: 10001947; rev: 4;)

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Apache2 <2.2.34 <2.4.27 Optionsbleed (CVE-2017-9798) Attempt"; flow: established, to_server; content: "OPTIONS"; http_method; threshold: type both, track by_src, count 20, seconds 30; reference: cve, 2017-9798; reference: url, blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html; reference: url, github.com/ptresearch/AttackDetection; metadata: Open Ptsecurity.com ruleset; metadata: updated_at 2019_07_25; classtype: attempted-recon; sid: 10001948; rev: 1;)

#CVE-2018-0171
#A vulnerability in the Smart Install feature of Cisco IOS Software and Cisco IOS XE Software could allow an unauthenticated, remote attacker to trigger a reload of an affected device, 
#resulting in a denial of service (DoS) condition, or to execute arbitrary code on an affected device. The vulnerability is due to improper validation of packet data. 
#An attacker could exploit this vulnerability by sending a crafted Smart Install message to an affected device on TCP port 4786. A successful exploit could allow the attacker to cause a buffer overflow on the affected device, 
#which could have the following impacts: Triggering a reload of the device, Allowing the attacker to execute arbitrary code on the device, Causing an indefinite loop on the affected device that triggers a watchdog crash. 
#Cisco Bug IDs: CSCvg76186.

alert tcp any any -> $HOME_NET 4786 (msg: "ATTACK [PTsecurity] Cisco Smart Install 15.2(5)E RCE (CVE-2018-0171)"; flow: established, to_server, no_stream; content: "|00 00 00 01 00 00 00 07|"; offset: 4; depth: 8; content: "|00 00 00 01|"; distance: 4; within: 4; isdataat: 210, relative; reference: cve, 2018-0171; reference: url, embedi.com/blog/cisco-smart-install-remote-code-execution; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002774; rev: 1; )

#CVE-2018-0886
#The Credential Security Support Provider protocol (CredSSP) in Microsoft Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1 and RT 8.1, 
#Windows Server 2012 and R2, Windows 10 Gold, 1511, 1607, 1703, and 1709 Windows Server 2016 and Windows Server, 
#version 1709 allows a remote code execution vulnerability due to how CredSSP validates request during the authentication process, aka "CredSSP Remote Code Execution Vulnerability".

alert tcp $HOME_NET 3389 -> any any (msg: "ATTACK [PTsecurity] MS RDP CredSSP Remote Code Execution MitM (CVE-2018-0886)"; flow: established, from_server, only_stream; content: "|16 03|"; content: "|0B|"; distance: 3; within: 1; content: "|06 09 2a 86 48 86 f7 0d 01 01 01|"; distance: 0; content: "D|00|i|00|s|00|a|00|l|00|l|00|o|00|w|00|S|00|t|00|a|00|r|00|t|00|I|00|f|00|O|00|n|00|B|00|a|00|t|00|t|00|e|00|r|00|i|00|e|00|s|00|"; nocase; distance: 0; content: "E|00|x|00|e|00|c|00|"; nocase; distance: 0; content: "C|00|o|00|m|00|m|00|a|00|n|00|d|00|"; nocase; distance: 0; reference: cve, 2018-0886; reference: url, blog.preempt.com/how-we-exploited-the-authentication-in-ms-rdp; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002831; rev: 1; )

#CVE-2018-1000006
#GitHub Electron versions 1.8.2-beta.3 and earlier, 1.7.10 and earlier, 1.6.15 and earlier has a vulnerability in the protocol handler, 
#specifically Electron apps running on Windows 10, 7 or 2008 that register custom protocol handlers can be tricked in arbitrary command execution if the user clicks on a specially crafted URL. 
#This has been fixed in versions 1.8.2-beta.4, 1.7.11, and 1.6.16.

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] GitHub Electron <1.8.2-beta.4, <1.7.11, <1.6.16 protocol handler RCE (CVE-2018-1000006)"; flow: established, from_server; content: "://"; content: "--gpu-launcher="; nocase; pcre: "/(powershell|cmd|python|bash|\.exe)/i"; reference: cve, 2018-1000006; reference: url, electronjs.org/blog/protocol-handler-fix; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002500; rev: 2; )

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] GitHub Electron <1.8.2-beta.4, <1.7.11, <1.6.16 protocol handler RCE (CVE-2018-1000006)"; flow: established, from_server; content: "://"; content: "-cmd-prefix="; nocase; pcre: "/(powershell|cmd|python|bash|\.exe)/i"; reference: cve, 2018-1000006; reference: url, electronjs.org/blog/protocol-handler-fix; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002501; rev: 3; )

#CVE-2018-1000207
#MODX Revolution version <=2.6.4 contains a Incorrect Access Control vulnerability in Filtering user parameters before passing them into phpthumb class that can result in Creating file with custom a filename and content. 
#This attack appear to be exploitable via Web request. This vulnerability appears to have been fixed in commit 06bc94257408f6a575de20ddb955aca505ef6e68.

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Modx Revolution CMS < 2.6.4 RCE by PoC (CVE-2018-1000207)"; flow: established, to_server; content: "POST"; http_method; content: "/connectors/system/phpthumb.php"; http_uri; content: "IMresizedData"; nocase; http_client_body; content: "cache_filename"; nocase; http_client_body; reference: cve, 2018-1000207; reference: url, rudnkh.me/posts/critical-vulnerability-in-modx-revolution-2-6-4; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003350; rev: 1;)

#CVE-2018-1111
#DHCP packages in Red Hat Enterprise Linux 6 and 7, Fedora 28, and earlier are vulnerable to a command injection flaw in the NetworkManager integration script included in the DHCP client. 
#A malicious DHCP server, or an attacker on the local network able to spoof DHCP responses, could use this flaw to execute arbitrary commands with root privileges on systems using NetworkManager and configured to obtain network configuration using the DHCP protocol.

alert udp any 67 -> $HOME_NET 68 (msg: "ATTACK [PTsecurity] DHCP Client Script WPAD option OS Command Injection (CVE-2018-1111)"; content: "|63 82 53 63|"; fast_pattern; content: "|FC|"; distance: 0; byte_extract: 1, 0, length, relative; content: "'"; within:length; pcre: "/[\x79\x28-\x2a\x77\xf9\x21\x2a\x35\x36\x33\x3a\x3b\x01-\x0f\x1a\x1c]/"; content:!"|00|"; within: 1; content:!"|01|"; within: 1; content:!"|02|"; within: 1; byte_jump: 1, 0, relative; content: "|FC|"; within: 1; byte_extract: 1, 0, length, relative; content: "'"; within:length; reference: cve, 2018-1111; reference: url, dynoroot.ninja; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002971; rev: 2; )

alert udp any 67 -> $HOME_NET 68 (msg: "ATTACK [PTsecurity] DHCP Client Script WPAD option Exploit (CVE-2018-1111)"; content: "|63 82 53 63|"; fast_pattern; content: "|FC|"; distance: 0; byte_extract: 1, 0, length, relative; content: "'"; within:length; pcre: "/^[\x20-\x7E]+(sh|nc|wget|curl|echo|cat|id|uname)/Ri"; reference: cve, 2018-1111; reference: url, dynoroot.ninja; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002975; rev: 1; )

#CVE-2018-1306
#The PortletV3AnnotatedDemo Multipart Portlet war file code provided in Apache Pluto version 3.0.0 could allow a remote attacker to obtain sensitive information,
#caused by the failure to restrict path information provided during a file upload. An attacker could exploit this vulnerability to obtain configuration data and other sensitive information.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Apache Portals Pluto 3.0.0 RCE (CVE-2018-1306)"; flow: established, to_server; content: "HEAD"; http_method; content: "/pluto/portal/File Upload"; http_uri; depth: 25; content: "<%"; http_client_body; content: ".jsp"; http_client_body; reference: cve, 2018-1306; reference: url, packetstormsecurity.com/files/149366/apacheportalspluto300-exec.txt; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10003786; rev: 1; )

#CVE-2018-14847
#MikroTik RouterOS through 6.42 allows unauthenticated remote attackers to read arbitrary files and remote authenticated attackers to write arbitrary files due to a directory traversal vulnerability in the WinBox interface.

alert tcp any any -> any any (msg: "ATTACK [PTsecurity] Mikrotik <6.42 Password disclosure path traversal (CVE-2018-14847)"; flow: established, to_server; content: "|01 00|"; offset: 1; depth: 2; content: "M2"; distance: 1; within: 2; content: "/../"; distance: 0; content: "/flash/rw/store/user.dat"; distance: 0; content: "|02 00 00 00 02 00 00 00|"; distance: 0; reference: cve, 2018-14847; reference: url, github.com/tenable/routeros/tree/master/poc/bytheway; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003917; rev: 1; )

#CVE-2018-15379
#A vulnerability in which the HTTP web server for Cisco Prime Infrastructure (PI) has unrestricted directory permissions could allow an unauthenticated, remote attacker to upload an arbitrary file. 
#This file could allow the attacker to execute commands at the privilege level of the user prime. This user does not have administrative or root privileges. 
#The vulnerability is due to an incorrect permission setting for important system directories. 
#An attacker could exploit this vulnerability by uploading a malicious file by using TFTP, which can be accessed via the web-interface GUI. 
#A successful exploit could allow the attacker to run commands on the targeted application without authentication.

alert udp any any -> any any (msg: "ATTACK [PTsecurity] Cisco Prime Infrastructure < 3.4.1 & 3.3.1 TFTP RCE (CVE-2018-15379)"; flow: established, from_server; content: "|00 03 00 01|"; depth: 4; content: "<%@"; flowbits: set, CVE.2018-15379.JSP1; flowbits: noalert; reference: cve, 2018-15379; reference: url, seclists.org/fulldisclosure/2018/Oct/19; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003907; rev: 1; )

alert udp any any -> any any (msg: "ATTACK [PTsecurity] Cisco Prime Infrastructure < 3.4.1 & 3.3.1 TFTP RCE (CVE-2018-15379)"; flow: established, from_server; content: "|00 03 00|"; depth: 3; content: "/CSCOlumos/"; content: "runrshell"; distance: 0; flowbits: isset, CVE.2018-15379.JSP1; reference: cve, 2018-15379; reference: url, seclists.org/fulldisclosure/2018/Oct/19; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003908; rev: 1; )

#CVE-2018-15442
#A vulnerability in the update service of Cisco Webex Meetings Desktop App for Windows could allow an authenticated, local attacker to execute arbitrary commands as a privileged user. 
#The vulnerability is due to insufficient validation of user-supplied parameters. 
#An attacker could exploit this vulnerability by invoking the update service command with a crafted argument. 
#An exploit could allow the attacker to run arbitrary commands with SYSTEM user privileges. 
#While the CVSS Attack Vector metric denotes the requirement for an attacker to have local access, administrators should be aware that in Active Directory deployments, 
#the vulnerability could be exploited remotely by leveraging the operating system remote management tools.

alert tcp any any -> any 445 (msg: "ATTACK [PTsecurity] Webexservice Service Probe (CVE-2018-15442)"; flow: established, to_server, no_stream; content: "SMB"; depth: 8; content: "|05 00 00|"; distance: 0; content: "|10 00|"; distance: 19; within: 3; content: "w|00|e|00|b|00|e|00|x|00|s|00|e|00|r|00|v|00|i|00|c|00|e|000000|"; nocase; distance: 0; reference: url, webexec.org; reference: cve, 2018-15442; flowbits: set, CVE.2018-15442.Probe; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003982; rev: 1; )

alert tcp any any -> any 445 (msg: "ATTACK [PTsecurity] Webexservice remote priveleged command execution (CVE-2018-15442)"; flow: established, to_server, no_stream; content: "SMB"; depth: 8; content: "|05 00 00|"; distance: 0; content: "|13 00|"; distance: 19; within: 3; content: "s|00|o|00|f|00|t|00|w|00|a|00|r|00|e|00|-|00|u|00|p|00|d|00|a|00|t|00|e|00|"; nocase; distance: 0; reference: url, webexec.org; reference: cve, 2018-15442; flowbits: isset, CVE.2018-15442.Probe; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003983; rev: 1; )

#CVE-2018-15454
#A vulnerability in the Session Initiation Protocol (SIP) inspection engine of Cisco Adaptive Security Appliance (ASA) Software and Cisco Firepower Threat Defense (FTD) Software could allow an unauthenticated, 
#remote attacker to cause an affected device to reload or trigger high CPU, resulting in a denial of service (DoS) condition. The vulnerability is due to improper handling of SIP traffic. 
#An attacker could exploit this vulnerability by sending SIP requests designed to specifically trigger this issue at a high rate across an affected device. Software updates that address this vulnerability are not yet available.

alert udp any any -> $HOME_NET 5060 (msg: "ATTACK [PTSecurity] Cisco ASA and Cisco FTD possible DoS (CVE-2018-15454)"; flow: no_stream; content: "SIP|2f|"; nocase; content: "Via:"; nocase; distance: 0; content: "SIP|2f|"; nocase; distance: 0; content: "|2f|UDP"; nocase; distance: 0; within: 10; content: "0.0.0.0"; distance: 0; within: 15; fast_pattern; content: "branch="; nocase; distance: 0; reference: url, www.securityfocus.com/bid/105768/; reference: cve, 2018-15454; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10004025; rev: 1;)

#CVE-2018-17245
#Kibana versions 4.0 to 4.6, 5.0 to 5.6.12, and 6.0 to 6.4.2 contain an error in the way authorization credentials are used when generating PDF reports. 
#If a report requests external resources plaintext credentials are included in the HTTP request that could be recovered by an external resource provider.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Kibana < 6.4.3 <5.6.13 Arbitrary File Inclusion/Disclosure/RCE attempt (CVE-2018-17245)"; flow: established, to_server; content: "/api/console/api_server"; http_uri; content: "SENSE_VERSION"; nocase; http_uri; distance: 0; pcre: "/apis\s*=\s*[^&]*(?:(?:%2e|\.)(?:%2e|\.)(?:%5c|%2f|\/|\\))/Ui"; reference: cve, 2018-17245; reference: url, www.cyberark.com/threat-research-blog/execute-this-i-know-you-have-it; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004231; rev: 1; )

#CVE-2018-5955
#An issue was discovered in GitStack through 2.3.10. User controlled input is not sufficiently filtered, allowing an unauthenticated attacker to add a user to the server via the username and password fields to the rest/user/ URI.

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] GitStack Arbitrary PHP upload RCE (CVE-2018-5955)"; flow: established, to_server; content: "/web/index.php?"; http_uri; content: ".git"; distance: 0; http_uri; content: "Authorization:"; http_header; nocase; content: "Basic"; distance: 0; http_header; nocase; pcre: "/Basic\s+/i"; base64_decode: offset 0, relative; base64_data; pcre: "/&\s/"; reference: url, blogs.securiteam.com/index.php/archives/3557; reference: cve, CVE-2018-5955; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002449; rev: 2;)

#CVE-2018-6789
#An issue was discovered in the base64d function in the SMTP listener in Exim before 4.90.1. By sending a handcrafted message, a buffer overflow may happen. This can be used to execute code remotely.

alert tcp any any -> $HOME_NET 25 (msg: "ATTACK [PTsecurity] Exim <4.90.1 Base64 Overflow RCE (CVE-2018-6789)"; flow: established, to_server, only_stream; content: "|0D 0A|AUTH"; pcre: "/AUTH\s+\S+\s+(?:[a-zA-Z0-9\+\/=]{4})*+[a-zA-Z0-9\+\/=]{3}\s/"; reference: cve, 2018-6789; reference: url, https://devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10002643; rev: 3; )

#CVE-2018-7445
#A buffer overflow was found in the MikroTik RouterOS SMB service when processing NetBIOS session request messages. 
Remote attackers with access to the service can exploit this vulnerability and gain code execution on the system. 
The overflow occurs before authentication takes place, so it is possible for an unauthenticated remote attacker to exploit it. 
All architectures and all devices running RouterOS before versions 6.41.3/6.42rc27 are vulnerable.

alert tcp any any -> $HOME_NET 139 (msg: "ATTACK [PTsecurity] Mikrotik <6.41.3 <6.42rc27 RCE Attempt (CVE-2018-7445)"; flow: established, to_server, no_stream; content: "|81 00|"; depth: 2; byte_test: 1, >, 0x20, 2, relative; content: "|00 00 00|"; distance: 0; reference: cve, 2018-7445; reference: url, www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002680; rev: 1; )

alert tcp any any -> $HOME_NET 139 (msg: "ATTACK [PTsecurity] ShellCode Upload Mikrotik <6.41.3 <6.42rc27 RCE (CVE-2018-7445)"; flow: established, to_server, only_stream; content: "|00 00 eb 02 00 00 eb 02|"; depth: 8; pcre: "/(?:\x00\x00\xeb\x02){10}/R"; reference: cve, 2018-7445; reference: url, www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002681; rev: 1; )

alert tcp $HOME_NET 139 -> any any (msg: "ATTACK [PTsecurity] Successful Mikrotik <6.41.3 <6.42rc27 RCE (CVE-2018-7445)"; flow: established, from_server, no_stream; content: "sh: "; depth: 4; reference: cve, 2018-7445; reference: url, www.coresecurity.com/advisories/mikrotik-routeros-smb-buffer-overflow; classtype: successful-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002682; rev: 1; )

#CVE-2018-7600
#Drupal before 7.58, 8.x before 8.3.9, 8.4.x before 8.4.6, and 8.5.x before 8.5.1 allows remote attackers to execute arbitrary code because of an issue affecting multiple subsystems with default or common module configurations.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Drupalgeddon2 <8.3.9 <8.4.6 <8.5.1 RCE through registration form (CVE-2018-7600)"; flow: established, to_server; content: "/user/register"; http_uri; content: "POST"; http_method; content: "drupal"; http_client_body; pcre: "/(%23|#)(access(?:_|%5f)callback|pre(?:_|%5f)render|post(?:_|%5f)render|lazy(?:_|%5f)builder)/Pi"; reference: cve, 2018-7600; reference: url, research.checkpoint.com/uncovering-drupalgeddon-2; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10002808; rev: 3;)

#CVE-2018-7602
#A remote code execution vulnerability exists within multiple subsystems of Drupal 7.x and 8.x. 
#This potentially allows attackers to exploit multiple attack vectors on a Drupal site, which could result in the site being compromised. 
#This vulnerability is related to Drupal core - Highly critical - Remote Code Execution - SA-CORE-2018-002. Both SA-CORE-2018-002 and this vulnerability are being exploited in the wild.

alert http any any -> $HOME_NET any (msg: "ATTACK [PTsecurity] Drupalgeddon2 <7.5.9 <8.4.8 <8.5.3 RCE (CVE-2018-7602)"; flow: established, to_server; content: "markup"; http_uri; pcre: "/(%2523|%23|#)markup/U"; pcre: "/(%2523|%23|#)type/U"; reference: cve, 2018-7602; reference: url, www.bleepingcomputer.com/news/security/hackers-dont-give-site-owners-time-to-patch-start-exploiting-new-drupal-flaw-within-hours/; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10002866; rev: 1; )

#CVE-2018-8495
#A remote code execution vulnerability exists when Windows Shell improperly handles URIs, aka "Windows Shell Remote Code Execution Vulnerability." This affects Windows Server 2016, Windows 10, Windows 10 Servers.

alert http any any -> any any (msg: "ATTACK [PTsecurity] MS Edge WScript Command Injection RCE (CVE-2018-8495)"; flow: established, from_server; content: "wshfile:"; nocase; http_server_body; fast_pattern; content: ".."; distance: 0; http_server_body; content: ".vbs"; distance: 0; nocase; http_server_body; pcre: "/wshfile:[^\x22\x27\s]+(\\|\/)\.\.(\\|\/)[^\x22\x27\s]+\.vbs/Qi"; reference: cve, 2018-8495; reference: url, leucosite.com/Microsoft-Edge-RCE; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10003930; rev: 2; )

#CVE-2018-8581
#An elevation of privilege vulnerability exists in Microsoft Exchange Server, aka "Microsoft Exchange Server Elevation of Privilege Vulnerability." This affects Microsoft Exchange Server.

alert http any any -> any any (msg: "ATTACK [PTsecurity] MS Exchange 2010-2019 Possible privilege escalation (CVE-2018-8581)"; flow: established, to_server; content: "POST"; http_method; content: "SOAPAction"; http_header; content: "Authorization: NTLM"; http_header; content: "m:SendNotificationResponseMessage"; http_client_body; reference: url, dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/; reference: cve, 2018-8581; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004420; rev: 1;)

#CVE-2019-0227
#A Server Side Request Forgery (SSRF) vulnerability affected the Apache Axis 1.4 distribution that was last released in 2006. 
#Security and bug commits commits continue in the projects Axis 1.x Subversion repository, legacy users are encouraged to build from source. 
#The successor to Axis 1.x is Axis2, the latest version is 1.7.9 and is not vulnerable to this issue.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Possible Apache Axis RCE via SSRF (CVE-2019-0227)"; flow: established, to_client; content: "30"; http_stat_code; content: "Location:"; http_header; content: "method"; distance: 0; http_header; pcre: "/(!|%21)(-|%2D|)+(>|%3E)/RHi"; content: "deployment"; distance: 0; http_header; reference: cve, 2019-0227; reference: url, rhinosecuritylabs.com/application-security/cve-2019-0227-expired-domain-rce-apache-axis; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10004698; rev: 1;)

#CVE-2019-0232
#When running on Windows with enableCmdLineArguments enabled, the CGI Servlet in Apache Tomcat 9.0.0.M1 to 9.0.17, 8.5.0 to 8.5.39 and 7.0.0 to 7.0.93
# is vulnerable to Remote Code Execution due to a bug in the way the JRE passes command line arguments to Windows. 
#The CGI Servlet is disabled by default. The CGI option enableCmdLineArguments is disable by default in Tomcat 9.0.x (and will be disabled by default in all versions in response to this vulnerability). 
#For a detailed explanation of the JRE behaviour, see Markus Wulftange's blog 
#(https://codewhitesec.blogspot.com/2016/02/java-and-command-line-injections-in-windows.html) and 
#this archived MSDN blog (https://web.archive.org/web/20161228144344/https://blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/).

alert http any any -> any any (msg: "ATTACK [PTsecurity] Apache Tomcat RCE on Windows (CVE-2019-0232)"; flow: established, to_server; content: "?&"; http_raw_uri; pcre: "/\.(?:bat|cmd)\?\&/I"; reference: cve, 2019-0232; reference: url, wwws.nightwatchcybersecurity.com/2019/04/30/remote-code-execution-rce-in-cgi-servlet-apache-tomcat-on-windows-cve-2019-0232; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004953; rev: 2;)

#CVE-2019-0708
#A remote code execution vulnerability exists in Remote Desktop Services formerly known as Terminal Services when an unauthenticated attacker connects to the target system using RDP and sends specially crafted requests, 
#aka 'Remote Desktop Services Remote Code Execution Vulnerability'.

alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #1)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 20|"; depth: 5; fast_pattern; content: "|17 03 01|"; distance: 32; within: 3; byte_test: 2, >, 450, 0, relative, big; flowbits: set, BlueKeep.pkt1; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004861; rev: 4;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #2)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 20|"; depth: 5; content: "|17 03 01 00 30|"; distance: 32; within: 5;  fast_pattern; flowbits: isset, BlueKeep.pkt1; flowbits: set, BlueKeep.pkt2; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004862; rev: 4;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #3)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 20|"; depth: 5; content: "|17 03 01 00 20|"; distance: 32; within: 5;  fast_pattern; flowbits: isset, BlueKeep.pkt2; flowbits: set, BlueKeep.pkt3; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004863; rev: 4;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (MCS Channel Join Requests)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 20|"; depth: 5; content: "|17 03 01 00 30|"; distance: 32; within: 5;  fast_pattern; flowbits: isset, BlueKeep.pkt3; flowint: JoinReq, +, 1; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004864; rev: 4;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #12)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 20|"; depth: 5; content: "|17 03 01 01 80|"; distance: 32; within: 5; flowint: JoinReq, >=, 7; flowbits: set, BlueKeep.pkt12; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004865; rev: 7;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708"; flow: established, from_server; app-layer-protocol:!tls; stream_size: client, <, 3500; stream_size: server, <, 3000; content: "|17 03 01 01 d0|"; depth: 5; flowbits: isset, BlueKeep.pkt12; flowbits: set, BlueKeep.pkt13; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004867; rev: 5;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #1)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01|"; depth: 3; byte_test: 2, >, 450, 0, relative, big; flowbits: set, BlueKeep.pkt1; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005396; rev: 1;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #2)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 30|"; depth: 5;  fast_pattern; flowbits: isset, BlueKeep.pkt1; flowbits: set, BlueKeep.pkt2; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005397; rev: 1;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #3)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 20|"; depth: 5; flowbits: isset, BlueKeep.pkt2; flowbits: set, BlueKeep.pkt3; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005398; rev: 1;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (MCS Channel Join Requests)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 00 30|"; depth: 5; flowbits: isset, BlueKeep.pkt3; flowint: JoinReq, +, 1; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005399; rev: 1;)
alert tcp any any -> any !443 (msg: "ATTACK [PTsecurity] Possible Bluekeep RDP exploit CVE-2019-0708 (pkt #12)"; flow: established, to_server; app-layer-protocol:!tls; content: "|17 03 01 01 80|"; depth: 5; flowint: JoinReq, >=, 7; flowbits: set, BlueKeep.pkt12; flowbits: noalert; reference: cve, 2019-0708; reference: url, github.com/Ekultek/BlueKeep; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005400; rev: 1;)

#CVE-2019-1003001
#A sandbox bypass vulnerability exists in Pipeline: Groovy Plugin 2.61 and earlier in src/main/java/org/jenkinsci/plugins/workflow/cps/CpsFlowDefinition.java, 
#src/main/java/org/jenkinsci/plugins/workflow/cps/CpsGroovyShellFactory.java 
#that allows attackers with Overall/Read permission to provide a pipeline script to an HTTP endpoint that can result in arbitrary code execution on the Jenkins master JVM.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Jenkins sandbox bypassing RCE (CVE-2019-1003000/1/2)"; flow: established, to_server; content: "POST"; http_method; nocase; content: "/job/"; http_uri; depth: 5; content: "/config.xml"; http_uri; content: "script"; http_client_body; pcre: "/<\s*script\s*>.*?@(Grab|ASTTest)/Ps";  reference: url, github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc; reference: cve, 2019-1003000; reference: cve, 2019-1003001; reference: cve, 2019-1003002; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004529; rev: 1; )

#CVE-2019-2618
#Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent: WLS Core Components). Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0 and 12.2.1.3.0. 
#Easily exploitable vulnerability allows high privileged attacker with network access via HTTP to compromise Oracle WebLogic Server. 
#Successful attacks of this vulnerability can result in unauthorized access to critical data or complete access to all Oracle WebLogic Server accessible data as well as unauthorized update, 
#insert or delete access to some of Oracle WebLogic Server accessible data. CVSS 3.0 Base Score 5.5 (Confidentiality and Integrity impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:N).

alert http any any -> any any (msg: "ATTACK [PTsecurity] Oracle Weblogic file upload RCE (CVE-2019-2618)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "/bea_wls_deployment_internal/DeploymentService"; http_uri; content: "app_upload"; http_header; content: "_WL_internal"; http_header; content: "bea_wls_"; http_header; distance: 0; reference: cve, 2019-2618; reference: url, github.com/jas502n/cve-2019-2618/blob/master/cve-2019-2618.py; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004781; rev: 1;)

#CVE-2019-2725
#Vulnerability in the Oracle WebLogic Server component of Oracle Fusion Middleware (subcomponent: Web Services). Supported versions that are affected are 10.3.6.0.0 and 12.1.3.0.0. 
#Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle WebLogic Server. 
#Successful attacks of this vulnerability can result in takeover of Oracle WebLogic Server. CVSS 3.0 Base Score 9.8 (Confidentiality, Integrity and Availability impacts). CVSS Vector: (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

alert http any any -> any any (msg: "ATTACK [PTsecurity] Oracle Weblogic _async deserialization RCE Attempt (CVE-2019-2725)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "oracle.toplink.internal.sessions.UnitOfWorkChangeSet"; pcre: "/(/wls-wsat/|/__async/)/I"; reference: cve, 2019-2725; reference: url, paper.seebug.org/910/; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004779; rev: 3;)
alert http any any -> any any (msg: "ATTACK [PTsecurity] Oracle Weblogic _async deserialization RCE Attempt (CVE-2019-2725)"; flow: established, to_server; content: "POST"; nocase; http_method; content: "org.slf4j.ext.EventData"; pcre: "/(/wls-wsat/|/__async/)/I"; reference: cve, 2019-2725; reference: url, paper.seebug.org/910/; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004927; rev: 1;)

#CVE-2019-3396
#The Widget Connector macro in Atlassian Confluence Server before version 6.6.12 (the fixed version for 6.6.x), from version 6.7.0 before 6.12.3 (the fixed version for 6.12.x), from version 6.13.0 before 6.13.3 (the fixed version for 6.13.x), and from version 6.14.0 before 6.14.2 (the fixed version for 6.14.x), allows remote attackers to achieve path traversal and remote code execution on a Confluence Server or Data Center instance via server-side template injection.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Confluence <6.14.2,6.13.3,6.12.3 Unauthorized RCE (CVE-2019-3396)"; flow: established, to_server; content: "/rest/tinymce/"; http_uri; content: "/macro/preview"; http_uri; distance: 0; content: "contentId"; http_client_body; content: "_template"; http_client_body; content: "url"; http_client_body; reference: url, paper.seebug.org/886; reference: cve, 2019-3396; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10004699; rev: 1; )

#CVE-2019-3924
#MikroTik RouterOS before 6.43.12 (stable) and 6.42.12 (long-term) is vulnerable to an intermediary vulnerability. The software will execute user defined network requests to both WAN and LAN clients.
#A remote unauthenticated attacker can use this vulnerability to bypass the router's firewall or for general network scanning activities.

alert tcp any any -> any 8291 (msg: "ATTACK [PTsecurity] MikroTik Firewall & NAT Bypass (CVE-2019-3924)"; flow: established, no_stream, to_server; content: "|01 00|"; depth: 4; content: "M2"; depth: 8; content: "|68 00 00 00|"; isdataat: !1, relative; content: "|07 00 FF 09 01|"; content: "|03 00 00 08|"; content: "|04 00 00 09|"; content: "|07 00 00 21|"; content: "|08 00 00 21|"; reference: cve, 2019-3924; reference: url, www.tenable.com/security/research/tra-2019-07; reference: url, github.com/tenable/routeros/blob/master/poc/cve_2019_3924; classtype: attempted-admin; reference: url, github.com/ptresearch/AttackDetection; sid: 10004547; rev: 1; )

#CVE-2019-3978
#RouterOS versions 6.45.6 Stable, 6.44.5 Long-term, and below allow remote unauthenticated attackers to trigger DNS queries via port 8291. The queries are sent from the router to a server of the attacker's choice. 
#The DNS responses are cached by the router, potentially resulting in cache poisoning

alert tcp any any -> any any (msg: "ATTACK [PTsecurity] Mikrotik RouterOS unauthenticated DNS cache poisoning (CVE-2019-3978)"; flow: established, to_server, no_stream; content: "M2"; offset: 4; depth: 2; content: "|01 00 00 08|"; content: "|07 00 FF 09 03|"; content: "|03 00 00 21|"; content: "|01 00 FF 88 01 00 0E 00 00 00|"; reference: cve, 2019-3978; reference: cve, medium.com/tenable-techblog/routeros-chain-to-root-f4e0b07c0b21; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005475; rev: 1;)

#CVE-2019-6340
#Some field types do not properly sanitize data from non-form sources in Drupal 8.5.x before 8.5.11 and Drupal 8.6.x before 8.6.10. This can lead to arbitrary PHP code execution in some cases. 
#A site is only affected by this if one of the following conditions is met: 
#The site has the Drupal 8 core RESTful Web Services (rest) module enabled and allows PATCH or POST requests, or the site has another web services module enabled, like JSON:API in Drupal 8, 
#or Services or RESTful Web Services in Drupal 7. (Note: The Drupal 7 Services module itself does not require an update at this time, but you should apply other contributed updates associated with this advisory if Services is in use.)

alert http any any -> any any (msg: "ATTACK [PTsecurity] Arbitrary PHP RCE in Drupal 8 < 8.5.11,8.6.10 (CVE-2019-6340)"; flow: established, to_server; content: "GET"; http_method; content: "hal_json"; http_uri; content: "link"; http_client_body; content: "options"; distance: 0; content: "O:"; distance: 0; http_client_body; pcre: "/\x22options\x22\s*:\s*\x22O:\d+:/P"; reference: cve, 2019-6340; reference: url, www.ambionics.io/blog/drupal8-rce; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10004555; rev: 3; )

#CVE-2020-0601
#A spoofing vulnerability exists in the way Windows CryptoAPI (Crypt32.dll) validates Elliptic Curve Cryptography (ECC) certificates.
#An attacker could exploit the vulnerability by using a spoofed code-signing certificate to sign a malicious executable, 
#making it appear the file was from a trusted, legitimate source, aka 'Windows CryptoAPI Spoofing Vulnerability'.

alert tcp any any -> any any (msg: "ATTACK [PTsecurity] Suspicious explicitly-defined ECC parameters. Possible CVE-2020-0601 crafted certificate"; flow:established; content:"|06 07 2a 86 48 ce 3d 02 01 30 82|"; content:"|06 07 2a 86 48 ce 3d 01 01 02|"; within:200; reference: cve, 2020-0601; reference: url, github.com/ollypwn/cve-2020-0601; reference: url, github.com/ptresearch/AttackDetection; classtype: trojan-activity; sid: 10005695; rev: 1;)

#CVE-2020-0796
#A remote code execution vulnerability exists in the way that the Microsoft Server Message Block 3.1.1 (SMBv3) protocol handles certain requests, aka 'Windows SMBv3 Client/Server Remote Code Execution Vulnerability'.

alert tcp any any -> any any (msg: "ATTACK [PTsecurity] CoronaBlue/SMBGhost DOS/RCE Attempt (CVE-2020-0796)"; flow: established; content: "|FC|SMB"; depth: 8; byte_test: 4, >, 0x800134, 8, relative, little; reference: url, www.mcafee.com/blogs/other-blogs/mcafee-labs/smbghost-analysis-of-cve-2020-0796; reference: cve, 2020-0796; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005777; rev: 2;)
alert tcp any any -> any any (msg: "ATTACK [PTsecurity] CoronaBlue/SMBGhost DOS/RCE Attempt (CVE-2020-0796)"; flow: established; content: "|FC|SMB"; depth: 8; byte_test: 4, >, 0x800134, 0, relative, little; reference: url, www.mcafee.com/blogs/other-blogs/mcafee-labs/smbghost-analysis-of-cve-2020-0796; reference: cve, 2020-0796; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005778; rev: 2;)

#CVE-2020-1350
#A remote code execution vulnerability exists in Windows Domain Name System servers when they fail to properly handle requests, aka 'Windows DNS Server Remote Code Execution Vulnerability'.

alert tcp any 53 -> any any (msg: "ATTACK [PTsecurity] Windows Server DNS RCE aka SIGRed (CVE-2020-1350) - Query response"; flow: established, from_server; content:"|FF|"; depth: 1; content: "|00 00 18 00 01 C0|"; within: 100; content:"|00 18 00 01|"; distance: 1; within: 4; content: "|FF|"; distance: 4; within: 1; reference: url, research.checkpoint.com/2020/resolving-your-way-into-domain-admin-exploiting-a-17-year-old-bug-in-windows-dns-servers; reference: cve, 2020-1350; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10005977; rev: 2;)

#CVE-2020-14882
#Vulnerability in the Oracle WebLogic Server product of Oracle Fusion Middleware (component: Console). 
#Supported versions that are affected are 10.3.6.0.0, 12.1.3.0.0, 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0. 
#Easily exploitable vulnerability allows unauthenticated attacker with network access via HTTP to compromise Oracle WebLogic Server. 
#Successful attacks of this vulnerability can result in takeover of Oracle WebLogic Server. CVSS 3.1 Base Score 9.8 (Confidentiality, Integrity and Availability impacts). CVSS Vector: (CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H).

alert http any any -> any any (msg: "ATTACK [PTsecurity] Oracle Weblogic unauth RCE (CVE-2020-14882)"; flow: established, to_server; content: "%252E%252E"; http_raw_uri; content: "console.portal"; http_uri; content: "tangosol"; content: "coherence"; distance: 0; content: "ShellSession"; distance: 0; reference: url, twitter.com/jas502n/status/1321416053050667009; reference: url, testbnull.medium.com/weblogic-rce-by-only-one-get-request-cve-2020-14882-analysis-6e4b09981dbf; reference: url, github.com/ptresearch/AttackDetection; reference: cve, 2020-14882; classtype: attempted-admin; sid: 10006254; rev: 1;)

#CVE-2021-41773
#A flaw was found in a change made to path normalization in Apache HTTP Server 2.4.49. An attacker could use a path traversal attack to map URLs to files outside the directories configured by Alias-like directives. 
#If files outside of these directories are not protected by the usual default configuration "require all denied", these requests can succeed. If CGI scripts are also enabled for these aliased pathes, 
#this could allow for remote code execution. This issue is known to be exploited in the wild. This issue only affects Apache 2.4.49 and not earlier versions. 
#The fix in Apache HTTP Server 2.4.50 was found to be incomplete, see CVE-2021-42013.

alert http any any -> any any (msg: "ATTACK [PTsecurity] Likely Apache HTTP Server 2.4.49 Directory Traversal (CVE-2021-41773)"; flow: established, to_server; content: "%2e/"; nocase; http_raw_uri; pcre: "/\/(\.|%2e)%2e\//Ii"; threshold: type limit, track by_src, count 1, seconds 60; reference: cve, 2021-41773; reference: url, twitter.com/lofi42/status/1445382059640434695; reference: url, github.com/ptresearch/AttackDetection; metadata: created_at 2021_10_05, updated_at 2021_10_06; classtype: web-application-attack; sid: 10006811; rev: 2;)
alert http any any -> any any (msg: "ATTACK [PTsecurity] Apache HTTP Server 2.4.49 RCE attempt (CVE-2021-41773)"; flow: established, to_server; content: "%2e/"; nocase; http_raw_uri; content: "sh"; distance: 0; nocase; http_raw_uri; pcre: "/\/(\.|%2e)%2e\//Ii"; content: "POST"; nocase; http_method; reference: cve, 2021-41773; reference: url, twitter.com/lofi42/status/1445382059640434695; reference: url, github.com/ptresearch/AttackDetection; classtype: attempted-admin; sid: 10006813; rev: 1;)

#CVE-2022-23131
#In the case of instances where the SAML SSO authentication is enabled (non-default), session data can be modified by a malicious actor, because a user login stored in the session was not verified. 
#Malicious unauthenticated actor may exploit this issue to escalate privileges and gain admin access to Zabbix Frontend. 
#To perform the attack, SAML authentication is required to be enabled and the actor has to know the username of Zabbix user (or use the guest account, which is disabled by default).

alert http any any -> any any (msg: "ATTACK [PTsecurity] Zabbix v5.4.x SSO/SALM Auth Bypass RCE (CVE-2022-23131)"; flow: established, to_server; content: "/index_sso.php"; http_uri; content: "zbx_session="; http_cookie; base64_decode: relative; base64_data; content: "saml_data"; content: "username_attribute"; distance: 0; pcre: "/^(?:(?!.*sessionid)|(?!.*sign)|(?!.*session_index))/"; reference: url, blog.sonarsource.com/zabbix-case-study-of-unsafe-session-storage; reference: url, github.com/ptresearch/AttackDetection; reference: cve, 2022-23131; classtype: attempted-admin; sid: 10007101; rev: 1;)

alert arp any any -> any any (msg:"ARP packet detected"; sid:1000001; rev:1;)
